{% extends 'based/base.html' %}

{% block content %}
<h2>{{ post.title }}</h2>
<p>{{ post.content }}</p>
<p><i>Автор: {{ post.created_by.username }} | {{ post.created_at }}</i></p>

{% if user.is_staff %}
  <form action="{% url 'delete_post' post.id %}" method="post" style="display:inline;">
    {% csrf_token %}
    <button type="submit" onclick="return confirm('Ви впевнені, що хочете видалити цей пост?');">Видалити пост</button>
  </form>
{% endif %}

<hr>
<h3>Коментарі:</h3>
{% for comment in comments %}
    <div style="margin-bottom: 10px;">
        <p>{{ comment.content }}</p>
        <small>— {{ comment.author.username }}, {{ comment.created_at }}</small>
    </div>
{% empty %}
    <p>Коментарів поки нема.</p>
{% endfor %}

{% if user.is_authenticated %}
    <hr>
    <h3>Залишити коментар:</h3>
    <form method="post">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit">Надіслати</button>
    </form>
{% else %}
    <p><a href="{% url 'login' %}?next={{ request.path }}">Увійдіть</a>, щоб залишити коментар.</p>
{% endif %}
{% endblock %}
